#ifndef __server_h__
#define __server_h__

#include <stdio.h>
#include <ev.h>

typedef struct {
    int sockfd;
    size_t max_body_len;
    size_t max_header_fields;
    size_t max_header_field_len;
    PyObject *wsgi_app;
    const char *host;
    int port;
} ServerInfo;

ServerInfo *get_server_info();
void set_server_info(ServerInfo *info);
void server_run();

#define SERVER_INFO get_server_info()

#define READ_BUFFER_SIZE 64*1024

#define Py_XCLEAR(obj) do { if(obj) { Py_DECREF(obj); obj = NULL; } } while(0)

#endif
